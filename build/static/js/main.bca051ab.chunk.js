(this.webpackJsonpcalendar=this.webpackJsonpcalendar||[]).push([[0],{123:function(e,t,n){},125:function(e,t,n){},153:function(e,t,n){},155:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(11),s=n.n(r),i=(n(123),n(31)),o=n(38),l=n(19),d=n.n(l),m=n(32),u=(n(125),n(99)),j=n(72),b=n(87),h=n.n(b),f=n(88),p=n.n(f),v=n(30),x=n.n(v);new URLSearchParams;function O(){return(O=Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={headers:{Accept:"application/json; odata=verbose"}},e.next=7;break;case 5:e.t1=e.sent,t.headers.Authorization=e.t0.concat.call(e.t0,e.t1);case 7:return e.abrupt("return",x.a.get("https://dvagov.sharepoint.com/sites/VAFMBTCalendars".concat("/_api/web/lists/getbytitle('CalendarConfig')/items"),t).then((function(e){return e.data.d.results})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g=function(){return O.apply(this,arguments)};function D(){return(D=Object(m.a)(d.a.mark((function e(){var t,n,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:t=e.sent,n={headers:{Accept:"application/json; odata=verbose"}},e.next=10;break;case 8:e.t1=e.sent,n.headers.Authorization=e.t0.concat.call(e.t0,e.t1);case 10:return c=[],t.forEach((function(e){c.push(x.a.get("".concat(e.SiteUrl.Url,"/_api/web/lists/getbytitle('").concat(e.Title,"')/items?$select=*,Duration,RecurrenceData&$expand=FieldValuesAsText,FieldValuesAsHtml, Properties"),n).then((function(e){return e.data.d.results})))})),e.abrupt("return",Promise.all(c).then(function(){var e=Object(m.a)(d.a.mark((function e(c){var a,r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],r={},t.forEach((function(e,t){r[e.Id]=c[t].filter((function(e){return"Yes"===e.Enterprise_x0020_Event})).map((function(e){return e.recurrenceValue=e.fRecurrence,e})),a[e.Id]=Promise.all(c[t].filter((function(e){return"Yes"===e.Enterprise_x0020_Event})).map((function(t){return Promise.all([x.a.get("".concat(e.SiteUrl.Url,"/_api/web/regionalsettings/timezone/utctolocaltime('").concat(t.EventDate,"')"),n),x.a.get("".concat(e.SiteUrl.Url,"/_api/web/regionalsettings/timezone/utctolocaltime('").concat(t.EndDate,"')"),n)])})))})),e.next=5,Promise.all(a);case 5:return s=e.sent,t.forEach((function(e,t){r[e.Id]=r[e.Id].map((function(t,n){return t.fAllDayEvent||(t.EventDate=new Date(s[e.Id][n][0].data.d.UTCToLocalTime),t.EndDate=new Date(s[e.Id][n][1].data.d.UTCToLocalTime),t.LinkToEdit="".concat(e.SiteUrl.Url,"/Lists/").concat(e.Title,"/EditForm.aspx?ID=").concat(t.Id)),t}))})),e.abrupt("return",{config:t,calendars:r});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=function(){return D.apply(this,arguments)},w=(n(153),n(202)),N=n(34),y=n(102),C=n(201),G=n(103),k=n(35),I=n(3);var T=function(e){var t,n=e.event,c=e.toggleHideDialog;return Object(I.jsx)("div",{className:"EventDetails",children:Object(I.jsxs)(w.a,{className:"event-details",hidden:!n,onDismiss:function(){return c(null)},dialogContentProps:{type:N.a.largeHeader,title:n.Title,closeButtonAriaLabel:"Close"},modalProps:{titleAriaId:"dialogLabel",subtitleAriaId:"subTextLabel",isBlocking:!1},children:[Object(I.jsxs)("div",{className:"ms-Grid",dir:"ltr",children:[Object(I.jsxs)("div",{className:"ms-Grid-row",children:[Object(I.jsx)("div",{className:"ms-Grid-col ms-sm4",children:Object(I.jsx)("label",{children:"Category:"})}),Object(I.jsx)("div",{className:"ms-Grid-col ms-sm8",children:n.Category})]}),Object(I.jsxs)("div",{className:"ms-Grid-row",children:[Object(I.jsx)("div",{className:"ms-Grid-col ms-sm4",children:Object(I.jsx)("label",{children:"Location:"})}),Object(I.jsx)("div",{className:"ms-Grid-col ms-sm8",children:n.Location})]}),Object(I.jsxs)("div",{className:"ms-Grid-row",children:[Object(I.jsx)("div",{className:"ms-Grid-col ms-sm4",children:Object(I.jsx)("label",{children:"Start Time:"})}),Object(I.jsxs)("div",{className:"ms-Grid-col ms-sm8",children:[k(n.EventDate).format("MM/DD/YYYY")," ",n.fAllDayEvent?null:k(n.EventDate).format("h:mm A")]})]}),Object(I.jsxs)("div",{className:"ms-Grid-row",children:[Object(I.jsx)("div",{className:"ms-Grid-col ms-sm4",children:Object(I.jsx)("label",{children:"End Time:"})}),Object(I.jsxs)("div",{className:"ms-Grid-col ms-sm8",children:[k(n.EndDate).format("MM/DD/YYYY")," ",n.fAllDayEvent?null:k(n.EndDate).format("h:mm A")]})]}),Object(I.jsxs)("div",{className:"ms-Grid-row description",children:[Object(I.jsx)("div",{className:"ms-Grid-col ms-sm4",children:Object(I.jsx)("label",{children:"Description:"})}),Object(I.jsx)("div",{className:"ms-Grid-col ms-sm8",children:Object(I.jsx)("div",{dangerouslySetInnerHTML:{__html:n.Description}})})]}),Object(I.jsxs)("div",{className:"ms-Grid-row",children:[Object(I.jsx)("div",{className:"ms-Grid-col ms-sm4",children:Object(I.jsx)("label",{children:"All Day Event:"})}),Object(I.jsx)("div",{className:"ms-Grid-col ms-sm8",children:n.fAllDayEvent?"Yes":"No"})]}),n.recurrenceValue?Object(I.jsxs)("div",{className:"ms-Grid-row",children:[Object(I.jsx)("div",{className:"ms-Grid-col ms-sm4",children:Object(I.jsx)("label",{children:"Recurrence:"})}),Object(I.jsx)("div",{className:"ms-Grid-col ms-sm8",children:n.RecurrenceData})]}):null,Object(I.jsx)("div",{className:"ms-Grid-row",children:Object(I.jsx)("div",{className:"ms-Grid-col ms-sm12",children:Object(I.jsx)("a",{rel:"noreferrer",target:"_blank",href:(t=n,["https://outlook.office.com/calendar/0/deeplink/compose?path=%2Fcalendar%2Faction%2Fcompose&rru=addevent","startdt=".concat(encodeURIComponent(k(t.EventDate).format("YYYY-MM-DDTHH:mm:ssZ"))),"enddt=".concat(encodeURIComponent(k(t.EndDate).format("YYYY-MM-DDTHH:mm:ssZ"))),"subject=".concat(encodeURIComponent(t.Title)),"location=".concat(encodeURIComponent(t.Location)),"body=".concat(encodeURIComponent(t.Description))].join("&")),children:"Add to Outlook"})})})]}),Object(I.jsxs)(y.a,{children:[Object(I.jsx)(C.a,{href:n.LinkToEdit,target:"_blank",text:"Edit"}),Object(I.jsx)(G.a,{onClick:function(){return c(null)},text:"Close"})]})]})})},A=Object(j.b)(h.a),Y=function(){var e=Object(m.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();var L=function(){var e=Object(u.a)({promiseFn:Y}),t=e.data,n=e.error,a=e.isLoading,r=Object(c.useState)([]),s=Object(o.a)(r,2),l=s[0],d=s[1],m=Object(c.useState)(null),b=Object(o.a)(m,2),h=b[0],f=b[1];if(a)return"Loading...";if(n)return"Something went wrong: ".concat(n.message);if(t){t.config.forEach((function(e,n){var c=new Date,a=new Date(c.getFullYear(),0,1),r=new Date(c.getFullYear(),11,21),s=p.a.parseEvents(t.calendars[e.Id],a,r);s=function(e,t){return e.map((function(e){return e.start=e.EventDate,e.end=e.EndDate,e.eventClasses="optionalEvent",e.title=e.Title,e.description=e.Description,e.blockColor=t.Color,e}))}(s,e),t.calendars[e.Id]=s}));var v=[];return Object.keys(t.calendars).filter((function(e){return-1===l.indexOf(parseInt(e))})).forEach((function(e){v=[].concat(Object(i.a)(v),Object(i.a)(t.calendars[e]))})),Object(I.jsxs)("div",{className:"App",children:[Object(I.jsx)("div",{className:"calendar-history",children:t.config.map((function(e){return Object(I.jsx)("div",{className:["history-item",-1!==l.indexOf(e.Id)?"hide":""].join(" "),style:{backgroundColor:e.Color},onClick:function(){return function(e){if(-1===l.indexOf(e))d([].concat(Object(i.a)(l),[e]));else{var t=l;t.splice(l.indexOf(e),1),d(Object(i.a)(t))}}(e.Id)},children:e.Title},e.Id)}))}),Object(I.jsx)("div",{children:Object(I.jsx)(j.a,{localizer:A,events:v,startAccessor:"start",endAccessor:"end",style:{height:700},views:["month","week","day"],eventPropGetter:function(e){return{className:e.className,style:{background:e.blockColor}}},onSelectEvent:function(e){f(e)}})}),h?Object(I.jsx)("div",{children:Object(I.jsx)(T,{event:h,toggleHideDialog:function(e){return f(e)}})}):null]})}},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,208)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};s.a.render(Object(I.jsx)(a.a.StrictMode,{children:Object(I.jsx)(L,{})}),document.getElementById("root")),U()}},[[155,1,2]]]);
//# sourceMappingURL=main.bca051ab.chunk.js.map