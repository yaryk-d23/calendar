{"version":3,"sources":["api/token.js","api/getConfig.js","api/api.js","components/EventDetails/EventDetails.js","App.js","reportWebVitals.js","index.js"],"names":["URLSearchParams","a","config","headers","axios","get","then","res","data","d","results","getConfig","calendarConfig","req","forEach","i","push","SiteUrl","Url","Title","Promise","all","timeSettings","calendars","key","Id","filter","x","Enterprise_x0020_Event","map","event","recurrenceValue","fRecurrence","EventDate","EndDate","timeSettingsRes","index","fAllDayEvent","Date","UTCToLocalTime","LinkToEdit","getEvents","EventDetails","e","toggleHideDialog","className","Dialog","hidden","onDismiss","dialogContentProps","type","DialogType","close","title","closeButtonAriaLabel","titleProps","modalProps","titleAriaId","subtitleAriaId","isBlocking","dir","Category","Location","dayjs","format","dangerouslySetInnerHTML","__html","Description","rel","target","href","encodeURIComponent","join","PrimaryButton","onClick","window","open","text","DefaultButton","localizer","momentLocalizer","moment","loadEvents","App","useAsync","promiseFn","error","isLoading","useState","hideCalendars","setHideCalendars","selectedEvent","setSelectedEvent","message","dt","startDate","getFullYear","endDate","parsedArray","spEventsParser","parseEvents","events","start","end","eventClasses","description","blockColor","Color","Object","keys","indexOf","parseInt","style","backgroundColor","id","tmp","splice","onClickCalendar","DisplayTitle","startAccessor","endAccessor","height","views","eventPropGetter","background","onSelectEvent","val","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.3522f7a9.chunk.js","sourcesContent":["import axios from \"axios\";\r\n\r\n\r\nconst params = new URLSearchParams()\r\n// params.append('grant_type', grant_type)\r\n// params.append('resource', resource)\r\n// params.append('client_id', client_id)\r\n// params.append('client_secret', client_secret)\r\n\r\nfunction getToken() {\r\n    return \"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyIsImtpZCI6Im5PbzNaRHJPRFhFSzFqS1doWHNsSFJfS1hFZyJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTBmZjEtY2UwMC0wMDAwMDAwMDAwMDAvY2hpcm9uaXRjb20uc2hhcmVwb2ludC5jb21AOWY2YTU3ZmEtZGRlMS00NDAwLWExZjUtOTIzNjRmNDNlZDMxIiwiaXNzIjoiMDAwMDAwMDEtMDAwMC0wMDAwLWMwMDAtMDAwMDAwMDAwMDAwQDlmNmE1N2ZhLWRkZTEtNDQwMC1hMWY1LTkyMzY0ZjQzZWQzMSIsImlhdCI6MTYyNDg5OTQwMCwibmJmIjoxNjI0ODk5NDAwLCJleHAiOjE2MjQ5ODYxMDAsImlkZW50aXR5cHJvdmlkZXIiOiIwMDAwMDAwMS0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDBAOWY2YTU3ZmEtZGRlMS00NDAwLWExZjUtOTIzNjRmNDNlZDMxIiwibmFtZWlkIjoiNDhlMmEzZDgtOGU1My00ODEzLTgwNzItMDk4ZGM4OGY1ZGYzQDlmNmE1N2ZhLWRkZTEtNDQwMC1hMWY1LTkyMzY0ZjQzZWQzMSIsIm9pZCI6IjQzZDVmMzM1LTFkZDQtNDI0MC1hODc2LWRlY2RiNTNhYjNjMCIsInN1YiI6IjQzZDVmMzM1LTFkZDQtNDI0MC1hODc2LWRlY2RiNTNhYjNjMCIsInRydXN0ZWRmb3JkZWxlZ2F0aW9uIjoiZmFsc2UifQ.EOHSB1T2lXnHiyyo1YZDZ9AfYwSjjfTP18d1sVbqhPXvzP1VaA3BusIYBiOw4xZDEdbxB_hbYgmjjG99rA3F5Q9tyMe39HpvI_ebbpH50Ri46WjwDj_BiBJ5sWy6T3-tgAmNFRMTh3DMBOMTektII_4XqugdtwICAV2lByVq6KUURsIhCaSiQ8foAfEQmQcwMBqhuz7lwNJlhXw0iYnU_UqCxLQyclqDEHrSICHR5VoC-QUVoIQzQUDLn8mMW5k46rDNfS_-C3uQ5y_QWJHdE-IvLw8lmksVToj3RMjFiJGJ1WPKg79eoVEUZDodVibGxCUJ3LPltT4tM0xMVfGYxw\";\r\n    return axios.post(\"https://accounts.accesscontrol.windows.net/9f6a57fa-dde1-4400-a1f5-92364f43ed31/tokens/OAuth/2\", params, {\r\n        headers: {\r\n            \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n        }\r\n    });\r\n}\r\nexport default getToken;","import axios from \"axios\";\r\nimport getToken from \"./token\";\r\n\r\nasync function getConfig() {\r\n    let config = {\r\n        headers: {\r\n            \"Accept\": \"application/json; odata=verbose\"\r\n        }\r\n    }\r\n    if(process.env.NODE_ENV === \"development\") {\r\n        config.headers[\"Authorization\"] = `Bearer ${await getToken()}`;\r\n    }\r\n    return axios.get(`${process.env.NODE_ENV === \"development\" ? \"https://chironitcom.sharepoint.com/sites/Demo/va\" : \"https://dvagov.sharepoint.com/sites/VAFMBTCalendars\"}/_api/web/lists/getbytitle('CalendarConfig')/items`, config).then(res => {\r\n        return res.data.d.results;\r\n    });\r\n}\r\n\r\nexport default getConfig;","\r\nimport axios from \"axios\";\r\nimport getToken from \"./token\";\r\nimport getConfig from \"./getConfig\";\r\n\r\n// function Api() {\r\n//     return {\r\n//         getEvents: getEvents\r\n//     };\r\n// }\r\n\r\nasync function getEvents() {\r\n    let calendarConfig = await getConfig();\r\n\r\n    let config = {\r\n        headers: {\r\n            \"Accept\": \"application/json; odata=verbose\"\r\n        }\r\n    }\r\n    if(process.env.NODE_ENV === \"development\") {\r\n        config.headers[\"Authorization\"] = `Bearer ${await getToken()}`;\r\n    }\r\n\r\n    let req = [];\r\n    calendarConfig.forEach(i => {\r\n        req.push(axios.get(`${i.SiteUrl.Url}/_api/web/lists/getbytitle('${i.Title}')/items?$select=*,Duration,RecurrenceData&$expand=FieldValuesAsText,FieldValuesAsHtml, Properties`, config).then(res => res.data.d.results));\r\n    });\r\n    return Promise.all(req).then(async res => {\r\n        let timeSettings = [];\r\n        let calendars = {};\r\n        calendarConfig.forEach((i, key) => {\r\n            calendars[i.Id] = res[key].filter(x => x.Enterprise_x0020_Event === 'Yes').map(event => { event.recurrenceValue = event.fRecurrence; return event; });\r\n            timeSettings[i.Id] = Promise.all(res[key].filter(x => x.Enterprise_x0020_Event === 'Yes').map(event => {\r\n                return Promise.all([\r\n                    axios.get(`${i.SiteUrl.Url}/_api/web/regionalsettings/timezone/utctolocaltime('${event.EventDate}')`, config),\r\n                    axios.get(`${i.SiteUrl.Url}/_api/web/regionalsettings/timezone/utctolocaltime('${event.EndDate}')`, config),\r\n                ]);\r\n            }));\r\n        });\r\n\r\n        let timeSettingsRes = await Promise.all(timeSettings);\r\n        calendarConfig.forEach((i, key) => {\r\n            calendars[i.Id] = calendars[i.Id].map((event, index) => {\r\n                if(!event.fAllDayEvent){\r\n                    event.EventDate = new Date(timeSettingsRes[i.Id][index][0].data.d.UTCToLocalTime);\r\n                    event.EndDate = new Date(timeSettingsRes[i.Id][index][1].data.d.UTCToLocalTime);\r\n                    event.LinkToEdit = `${i.SiteUrl.Url}/Lists/${i.Title}/EditForm.aspx?ID=${event.Id}`;\r\n                }\r\n                return event;\r\n            });\r\n        });\r\n        return {\r\n            config: calendarConfig,\r\n            calendars: calendars\r\n        };\r\n    });\r\n}\r\n\r\nexport default getEvents;","import React from 'react';\r\nimport './EventDetails.css';\r\nimport { Dialog, DialogType, DialogFooter } from '@fluentui/react/lib/Dialog';\r\nimport { PrimaryButton, DefaultButton } from '@fluentui/react/lib/Button';\r\nimport * as dayjs from 'dayjs'\r\n\r\n\r\nfunction EventDetails({ event, toggleHideDialog }) {\r\n    const generateOutlookExport = (e) => {\r\n        let params = [\r\n            \"https://outlook.office.com/calendar/0/deeplink/compose?path=%2Fcalendar%2Faction%2Fcompose&rru=addevent\",\r\n            `startdt=${encodeURIComponent(dayjs(e.EventDate).format(\"YYYY-MM-DDTHH:mm:ss+00:00\"))}`,\r\n            `enddt=${encodeURIComponent(dayjs(e.EndDate).format(\"YYYY-MM-DDTHH:mm:ss+00:00\"))}`,\r\n            // `enddt=${encodeURIComponent(\"2022-01-12T20:00:00+00:00\")}`,\r\n            `subject=${encodeURIComponent(e.Title)}`,\r\n            `location=${encodeURIComponent(e.Location)}`,\r\n            `body=${encodeURIComponent(e.Description)}`,\r\n        ];\r\n        return params.join(\"&\");\r\n    }\r\n    return (\r\n        <div className=\"EventDetails\">\r\n            <Dialog\r\n                className='event-details'\r\n                hidden={!event}\r\n                onDismiss={() => toggleHideDialog(null)}\r\n                dialogContentProps={{\r\n                    type: DialogType.close,\r\n                    title: event.Title,\r\n                    closeButtonAriaLabel: 'Close',\r\n                    titleProps: {\r\n                        hidden: true\r\n                    }\r\n                }}\r\n                modalProps={{\r\n                    titleAriaId: 'dialogLabel',\r\n                    subtitleAriaId: 'subTextLabel',\r\n                    isBlocking: false,\r\n                }}\r\n            >\r\n                <div className=\"form-header\">\r\n                    <div className=\"event-title\">{event.Title}</div>\r\n                </div>\r\n                <div className=\"ms-Grid\" dir=\"ltr\">\r\n                    {/* <div className=\"ms-Grid-row\">\r\n                        <div className=\"ms-Grid-col ms-sm4\">\r\n                            <label>Title:</label>\r\n                        </div>\r\n                        <div className=\"ms-Grid-col ms-sm8\">{event.Title}</div>\r\n                    </div> */}\r\n                    <div className=\"ms-Grid-row\">\r\n                        <div className=\"ms-Grid-col ms-sm4\">\r\n                            <label>Category:</label>\r\n                        </div>\r\n                        <div className=\"ms-Grid-col ms-sm8\">{event.Category}</div>\r\n                    </div>\r\n                    <div className=\"ms-Grid-row\">\r\n                        <div className=\"ms-Grid-col ms-sm4\">\r\n                            <label>Location:</label>\r\n                        </div>\r\n                        <div className=\"ms-Grid-col ms-sm8\">{event.Location}</div>\r\n                    </div>\r\n                    <div className=\"ms-Grid-row\">\r\n                        <div className=\"ms-Grid-col ms-sm4\">\r\n                            <label>Start Time:</label>\r\n                        </div>\r\n                        <div className=\"ms-Grid-col ms-sm8\">{dayjs(event.EventDate).format(\"MM/DD/YYYY\")}{\" \"}\r\n                        {!event.fAllDayEvent ? dayjs(event.EventDate).format(\"h:mm A\") : null}</div>\r\n                    </div>\r\n                    <div className=\"ms-Grid-row\">\r\n                        <div className=\"ms-Grid-col ms-sm4\">\r\n                            <label>End Time:</label>\r\n                        </div>\r\n                        <div className=\"ms-Grid-col ms-sm8\">{dayjs(event.EndDate).format(\"MM/DD/YYYY\")}{\" \"}\r\n                        {!event.fAllDayEvent ? dayjs(event.EndDate).format(\"h:mm A\") : null}</div>\r\n                    </div>\r\n                    <div className=\"ms-Grid-row description\">\r\n                        <div className=\"ms-Grid-col ms-sm4\">\r\n                            <label>Description:</label>\r\n                        </div>\r\n                        <div className=\"ms-Grid-col ms-sm8\">\r\n                            <div dangerouslySetInnerHTML={{ __html: event.Description }}></div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"ms-Grid-row\">\r\n                        <div className=\"ms-Grid-col ms-sm4\">\r\n                            <label>All Day Event:</label>\r\n                        </div>\r\n                        <div className=\"ms-Grid-col ms-sm8\">{event.fAllDayEvent ? \"Yes\" : \"No\"}</div>\r\n                    </div>\r\n                    {event.recurrenceValue ? <div className=\"ms-Grid-row\">\r\n                        <div className=\"ms-Grid-col ms-sm4\">\r\n                            <label>Recurrence:</label>\r\n                        </div>\r\n                        <div className=\"ms-Grid-col ms-sm8\">{event.recurrenceValue ? \"Yes\" : \"No\"}</div>\r\n                    </div> : null}\r\n                    <div className=\"ms-Grid-row\">\r\n                        <div className=\"ms-Grid-col ms-sm12\">\r\n                            <a rel=\"noreferrer\" target=\"_blank\" href={generateOutlookExport(event)}>Add to Outlook</a>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"action-block\">\r\n                    <PrimaryButton onClick={() => window.open(event.LinkToEdit, \"_blank\")} text=\"Edit\" />\r\n                    <DefaultButton onClick={() => toggleHideDialog(null)} text=\"Close\" />\r\n                </div>\r\n                    <div className=\"form-footer\"></div>\r\n            </Dialog>\r\n        </div>\r\n    );\r\n}\r\n\r\n\r\nexport default EventDetails;\r\n","import React, { useState } from 'react';\nimport './App.css';\nimport { useAsync } from 'react-async';\nimport { Calendar, momentLocalizer } from 'react-big-calendar'\nimport moment from 'moment'\nimport spEventsParser from \"sharepoint-events-parser\";\n\nimport getEvents from \"./api/api\"\nimport EventDetails from \"./components/EventDetails/EventDetails\";\n\nconst localizer = momentLocalizer(moment)\nconst loadEvents = async () => await getEvents();\n\nfunction App() {\n  const { data, error, isLoading } = useAsync({ promiseFn: loadEvents });\n  const [hideCalendars, setHideCalendars] = useState([]);\n  const onClickCalendar = function (id) {\n    if (hideCalendars.indexOf(id) === -1) {\n      setHideCalendars([...hideCalendars, id]);\n    }\n    else {\n      let tmp = hideCalendars;\n      tmp.splice(hideCalendars.indexOf(id), 1)\n      setHideCalendars([...tmp]);\n    }\n  }\n  const [selectedEvent, setSelectedEvent] = useState(null);\n  if (isLoading) return \"Loading...\"\n  if (error) return `Something went wrong: ${error.message}`\n  if (data) {\n    data.config.forEach((i, key) => {\n      let dt = new Date();\n      let startDate = new Date(dt.getFullYear(), 0, 1); //start from the 25th of last month\n      let endDate = new Date(dt.getFullYear(), 11, 21);\n      let parsedArray = spEventsParser.parseEvents(data.calendars[i.Id], startDate, endDate);\n      parsedArray = parseEvents(parsedArray, i);\n      data.calendars[i.Id] = parsedArray;\n    });\n    // const parsedArray = spEventsParser.parseEvents(data.data.d.results);\n    let events = [];\n    Object.keys(data.calendars).filter(x => {\n      return hideCalendars.indexOf(parseInt(x)) === -1;\n    }).forEach(key => {\n      events = [...events, ...data.calendars[key]];\n    });\n    return (\n      <div className=\"App\">\n        <div className=\"calendar-history\">\n          {data.config.map(i => {\n            return (<div key={i.Id} className={[\"history-item\", hideCalendars.indexOf(i.Id) !== -1 ? \"hide\" : \"\"].join(\" \")} style={{ backgroundColor: i.Color }} onClick={() => onClickCalendar(i.Id)}>\n              {i.DisplayTitle}\n            </div>);\n          })}\n        </div>\n        <div>\n          <Calendar\n            localizer={localizer}\n            events={events}\n            startAccessor=\"start\"\n            endAccessor=\"end\"\n            style={{ height: 700 }}\n            views={['month', 'week', 'day']}\n            eventPropGetter={(event) => {\n              return {\n                className: event.className,\n                style: { background: event.blockColor }\n              }\n            }}\n            onSelectEvent={(e) => {\n              setSelectedEvent(e);\n            }}\n          />\n        </div>\n        {!!selectedEvent ? <div>\n          <EventDetails event={ selectedEvent } toggleHideDialog={(val) => setSelectedEvent(val)}/>\n        </div> : null}\n      </div>\n    );\n  }\n}\n\n\nfunction parseEvents(events, config) {\n  return events.map(event => {\n    event.start = event.EventDate;\n    event.end = event.EndDate;\n    event.eventClasses = 'optionalEvent';\n    event.title = event.Title;\n    event.description = event.Description;\n    event.blockColor = config.Color;\n    return event;\n  });\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}