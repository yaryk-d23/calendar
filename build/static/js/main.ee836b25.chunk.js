(this.webpackJsonpcalendar=this.webpackJsonpcalendar||[]).push([[0],{51:function(e,t,n){},53:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(4),o=n.n(c),s=(n(51),n(15)),i=n(9),u=n.n(i),l=n(12),d=(n(53),n(44)),p=n(28),f=n(42),h=n.n(f),b=n(43),v=n.n(b),m=n(13),g=n.n(m),j="9f6a57fa-dde1-4400-a1f5-92364f43ed31",w="48e2a3d8-8e53-4813-8072-098dc88f5df3@".concat(j),y="00000003-0000-0ff1-ce00-000000000000/".concat("chironitcom.sharepoint.com","@").concat(j),O=new URLSearchParams;O.append("grant_type","client_credentials"),O.append("resource",y),O.append("client_id",w),O.append("client_secret","GT85uijE9wRHaGAJWVkHWzu3oCwZW3um2YmJV+0xZnI=");var x=function(){return g.a.post("https://accounts.accesscontrol.windows.net/9f6a57fa-dde1-4400-a1f5-92364f43ed31/tokens/OAuth/2",O,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})};function k(){return(k=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Accept:"application/json; odata=verbose"}},e.abrupt("return",g.a.get("https://dvagov.sharepoint.com/sites/VAFMBT/_api/web/lists/getbytitle('CalendarConfig')/items",t).then((function(e){return e.data.d.results})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C=function(){return k.apply(this,arguments)};function A(){return(A=Object(l.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:return t=e.sent,e.t0="Bearer ",e.next=6,x();case 6:return e.t1=e.sent,e.t2=e.t0.concat.call(e.t0,e.t1),e.t3={Accept:"application/json; odata=verbose",Authorization:e.t2},n={headers:e.t3},a=[],t.forEach((function(e){a.push(g.a.get("".concat(e.SiteUrl.Url,"/_api/web/lists/getbytitle('").concat(e.Title,"')/items?$select=*,Duration,RecurrenceData"),n).then((function(e){return e.data.d.results})))})),e.abrupt("return",Promise.all(a).then((function(e){var n={};return t.forEach((function(t,a){n[t.Id]=e[a]})),{config:t,calendars:n}})));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D=function(){return A.apply(this,arguments)},E=n(7),F=Object(p.b)(h.a),T=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();var I=function(){var e=Object(d.a)({promiseFn:T}),t=e.data,n=e.error;if(e.isLoading)return"Loading...";if(n)return"Something went wrong: ".concat(n.message);if(t){t.config.forEach((function(e,n){var a=new Date,r=new Date(a.getFullYear(),0,1),c=new Date(a.getFullYear(),11,21),o=v.a.parseEvents(t.calendars[e.Id],r,c);o=function(e,t){return e.map((function(e){return e.start=e.EventDate,e.end=e.EndDate,e.eventClasses="optionalEvent",e.title=e.Title,e.description=e.Description,e.blockColor=t.Color,e}))}(o,e),t.calendars[e.Id]=o}));var a=[];return Object.keys(t.calendars).map((function(e){a=[].concat(Object(s.a)(a),Object(s.a)(t.calendars[e]))})),Object(E.jsxs)("div",{className:"App",children:[Object(E.jsx)("div",{className:"calendar-history",children:t.config.map((function(e){return Object(E.jsx)("div",{className:"history-item",style:{backgroundColor:e.Color},children:e.Title})}))}),Object(E.jsx)("div",{children:Object(E.jsx)(p.a,{localizer:F,events:a,startAccessor:"start",endAccessor:"end",style:{height:700},views:["month","week","day"],eventPropGetter:function(e){return{className:e.className,style:{background:e.blockColor}}}})})]})}},_=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,86)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)}))};o.a.render(Object(E.jsx)(r.a.StrictMode,{children:Object(E.jsx)(I,{})}),document.getElementById("root")),_()}},[[82,1,2]]]);
//# sourceMappingURL=main.ee836b25.chunk.js.map